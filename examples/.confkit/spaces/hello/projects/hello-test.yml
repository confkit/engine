project:
  name: "hello-test"
  type: "hello"
  description: "权限测试项目"

environment:
  TEST_VAR: "hello-test"

steps:
  - name: "测试本地执行"
    commands:
      - "echo 'Local execution test'"
      - "mkdir -p ./volumes/workspace/test-${TASK_ID}"
      - "echo 'Created workspace directory'"
    timeout: "1m"

  - name: "测试容器执行"
    container: "hello-builder"
    commands:
      - "echo 'Container execution test'"
      - "pwd"
      - "ls -la /workspace"
      - "echo 'Testing write permissions'"
      - "echo 'test-content' > /workspace/test-${TASK_ID}/test-file.txt"
      - "cat /workspace/test-${TASK_ID}/test-file.txt"
    timeout: "1m"

  - name: "测试产物收集"
    container: "hello-builder"
    commands:
      - "echo 'Artifact collection test'"
      - "echo '{\"test\":\"success\",\"task_id\":\"${TASK_ID}\"}' > /artifacts/${TASK_ID}/test-result.json"
      - "ls -la /artifacts/${TASK_ID}/"
      - "cat /artifacts/${TASK_ID}/test-result.json"
    timeout: "1m"

step_options:
  retry: 1
  timeout: "5m"